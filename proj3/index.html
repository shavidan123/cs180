<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS180 Project 3 - Face Morphing</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="content">
            <h1>Facial Morphing and Caricatures</h1>

            <!-- Section 1: Facial Keypoints and Triangulation -->
            <div class="section" id="section1">
                <h2>Facial Keypoints and Triangulation</h2>
                <p>This section displays facial keypoints selected from two images: one of myself from freshman year, and one of myself today. Using Delaunay triangulation, a mesh is created for the face, which is used for the morphing process. You can see the original images, keypoints, and triangulation below:</p>
                
                <div class="gallery-section">
                    <div class="image-box">
                        <img src="images/avi/rsz_1currentavinoglasses.jpg" alt="Current Avi">
                        <p>Current Avi</p>
                    </div>
                    <div class="image-box">
                        <img src="images/avi/rsz_1freshmanavi.jpg" alt="Freshman Avi">
                        <p>Freshman Avi</p>
                    </div>
                    <div class="image-box">
                        <img src="images/triangulations/avitriangulations.png" alt="Facial Triangulation">
                        <p>Facial Triangulation</p>
                    </div>
                </div>
            </div>

            <hr class="section-divider">

            <!-- Section 2: Affine Warp and Midway Face -->
            <div class="section" id="section2">
                <h2>Affine Warp and Midway Face</h2>
                <p>An affine warp was used to create a midway face between the two images by leveraging the triangulation. To compute the midway face, I developed the framework necessary for creating the full morph sequence. This involved calculating the affine transformation to align the triangulations of both images to an averaged one, using matrix equations to solve for each correspondence. Additionally, since morphing involves blending pixel values, I initially implemented bilinear interpolation for averaging pixels between the images but found it too slow, so I switched to regularGridInterpolation. Using the completed morph function with both warp and dissolve fractions set to 0.5, I generated the midway face for both image sets. Below, you can see the original faces and the midway face:</p>
                
                <div class="gallery-section">
                    <div class="image-box">
                        <img src="images/avi/rsz_1freshmanavi.jpg" alt="Freshman Me">
                        <p>Freshman Me</p>
                    </div>
                    <div class="image-box">
                        <img src="images/morphs/midwaymorph.png" alt="Midway Face">
                        <p>Midway Face</p>
                    </div>
                    <div class="image-box">
                        <img src="images/avi/rsz_1currentavinoglasses.jpg" alt="Current Me">
                        <p>Current Me</p>
                    </div>
                </div>
            </div>

            <hr class="section-divider">

            <!-- Section 3: Morph Sequence GIF -->
            <div class="section" id="section3">
                <h2>Morph Sequence GIF</h2>
                <p>A sequence of morphed images was generated between the two faces, essentially showing the transformation from one image to the other. Below is a GIF showing the full morph sequence:</p>
                
                <div class="image-box">
                    <img id="morphGif" src="images/morphs/morph_sequence.gif" alt="Morph Sequence GIF">
                </div>
                <button onclick="resetGif()">Reset GIF</button>
            </div>

            <hr class="section-divider">

            <!-- Section 4: Mean Face from Danes Dataset -->
            <div class="section" id="section4">
                <h2>Mean Face from Danes Dataset</h2>
                <p>The mean face was computed from the Danes dataset by averaging keypoints and warping images to the mean shape. There are some artifacts in the final result, but they aren't as prominent in the versions of the images used for the calculations. Below are some other Dane faces morphed into the mean shape, and examples of my face morphed into the mean face's geometry:</p>
                
                <div class="gallery-section">
                    <div class="image-box">
                        <img src="images/morphs/average_dane_face.png" alt="Dane Mean Shape">
                        <p>Dane Mean Shape</p>
                    </div>
                    <div class="image-box">
                        <img src="images/morphs/danesmorphed.png" alt="Danes Morphed">
                        <p>Danes Morphed to Mean Shape</p>
                    </div>
                    <div class="image-box">
                        <img src="images/morphs/avitodane.png" alt="My Face to Dane Mean">
                        <p>My Face Morphed to Dane Mean Face</p>
                    </div>
                </div>

                <p>It's interesting to see how the mean face captures the average facial features of the Danes dataset. The morphed faces show how the average face can be used to transform other faces into a more "average" and kind of rounded appearance.</p>
            </div>

            <hr class="section-divider">

            <!-- Section 5: Caricature -->
            <div class="section" id="section5">
                <h2>Caricature</h2>
                <p>Various caricatures were generated by exaggerating the difference between my face and the average face. Below are the caricatures at different alpha values:</p>
                
                <div class="gallery-section">
                    <div class="image-box">
                        <img src="images/caricatures/caricature_0.png" alt="Caricature -0.5">
                        <p>Caricature Alpha = -0.5</p>
                    </div>
                    <div class="image-box">
                        <img src="images/caricatures/caricature_1.png" alt="Caricature 0">
                        <p>Caricature Alpha = 0</p>
                    </div>
                    <div class="image-box">
                        <img src="images/caricatures/caricature_2.png" alt="Caricature 0.5">
                        <p>Caricature Alpha = 0.5</p>
                    </div>
                    <div class="image-box">
                        <img src="images/caricatures/caricature_3.png" alt="Caricature 1">
                        <p>Caricature Alpha = 1</p>
                    </div>
                    <div class="image-box">
                        <img src="images/caricatures/caricature_4.png" alt="Caricature 1.5">
                        <p>Caricature Alpha = 1.5</p>
                    </div>
                    <div class="image-box"></div>
                        <img src="images/caricatures/caricature_5.png" alt="Caricature 2">
                        <p>Caricature Alpha = 2</p>
                    </div>
                    <div class="image-box"></div>
                        <img src="images/caricatures/caricature_6.png" alt="Caricature 3">
                        <p>Caricature Alpha = 3</p>
                    </div>
                </div>
                <p>Sadly, it seems I get a bit more round!</p>
            </div>

            <hr class="section-divider">

            <!-- Section 6: Gender Morphing -->
            <div class="section" id="section6">
                <h2>Gender Morphing</h2>
                <p>Using the average female face calcualted from the women in the Danes dataset, I morphed my face into a woman by changing its shape, appearance, and both. Below are the results:</p>
                
                <div class="gallery-section">
                    <div class="image-box">
                        <img src="images/triangulations/avifemaledanetriangulations.png" alt="Triangulations of My Face and Female Dane">
                        <p>Triangulations of My Face and Female Dane</p>
                    </div>
                    <div class="image-box">
                        <img src="images/female_avi/morphed_avi_female_shape.png" alt="Shape Morph">
                        <p>Shape Morph</p>
                    </div>
                    <div class="image-box">
                        <img src="images/female_avi/morphed_avi_female_color.png" alt="Appearance Morph">
                        <p>Appearance Morph</p>
                    </div>
                    <div class="image-box">
                        <img src="images/female_avi/morphed_avi_female.png" alt="Shape and Appearance Morph">
                        <p>Shape + Appearance Morph</p>
                    </div>
                </div>
            </div>

            <hr class="section-divider">

            <!-- Conclusion Section -->
            <div class="section" id="section7">
                <h2>Conclusion</h2>
                <p>This project explored facial keypoint selection, triangulation, affine warping, morphing, computing mean faces, and generating caricatures. These methods allow for powerful image transformations!</p>
            </div>
        </div>
    </div>

    <script>
        // Function to reset GIF by reloading the source
        function resetGif() {
            var gif = document.getElementById('morphGif');
            gif.src = gif.src;
        }
    </script>
</body>
</html>
